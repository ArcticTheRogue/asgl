#!/bin/bash

asgl_home="$HOME/.local/share/asgl"
asgl_games="$asgl_home/games"

[ ! -d "$asgl_home" ] && echo "Creating asgl home directory." && mkdir -pv "$asgl_home"
[ ! -d "$asgl_games" ] && echo "Creating asgl game directory." && mkdir -pv "$asgl_games"

add() {
    clear
    read -rp "What is the name of the game?: " nameofgame
    read -rp "Where is the executable for $nameofgame?: " locationofgame
    read -rp "Would you like to save this game?: [y/n] " command
    case $command in
        [Yy]*) 
                echo "Adding $nameofgame"
                newgame="$asgl_games/$nameofgame.sh"
                echo "$locationofgame" > "$newgame"
                chmod +x "$newgame"
                echo 'Game Added!'
                ;;
        [Nn]*) echo "$nameofgame not added!";;
        *) echo "Not a valid option."
    esac
    menu
}

launch() {
    clear
    read -rp "What game would you like to play?: " nameofgame
    sh "$asgl_games/$nameofgame.sh"
    menu
}

list() {
    clear
    echo 
    ls "$asgl_games" | awk -F. '{ print $1 }'
    echo 
    menu
}

help() {
    clear
    echo -e "
    a/A -------- Add a game.
    p/P -------- Play a game.
    l/L -------- List games.
    h/H -------- List of commands.
    q/Q -------- Exit.
    " 
    menu
}

menu() {
    clear
    read -rp "Type a command (h for help): " answer
        case $answer in
            [Aa]*) add;;
            [Pp]*) launch;;
            [Ll]*) list;;
            [Hh]*) help;;
            [Qq]*) echo "Exiting asgl. Goodbye." && exit 0;;
            *) echo "Not a valid option, exiting." && exit 1;;
        esac
}

menu